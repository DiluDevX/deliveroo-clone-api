<div>
  <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgNDAwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjx0aXRsZT5BcnRib2FyZDwvdGl0bGU+PHBhdGggZD0iTTExNi40MSA1OS45MjZsLTEuMTMzLTUuMjhWMjMuMTcyaC02LjU0MnYxNC4zNTdjLTEuOTY4LTIuMjctNC42NzUtMy42LTcuODctMy42LTYuNTQ1IDAtMTEuNjEgNS4zNzYtMTEuNjEgMTMuMjcgMCA3Ljg5NSA1LjA2NSAxMy4yNzIgMTEuNjEgMTMuMjcyIDMuMjQ2IDAgNi4wNS0xLjM4MyA4LjAxOC0zLjc1MmwuNjg4IDMuMjA3aDYuODR6bTEyNi4xOC0xNy44MWwzLjEtNi45NTZjLTEuNDI4LS44OS0zLjEtMS4yODMtNC43MjItMS4yODMtMi45NTIgMC01LjQxMiAxLjMyOC02Ljk4NSAzLjhsLS42OS0zLjIxaC02Ljc0bDEuMDgyIDQuOTgyVjU5LjkyaDYuNTR2LTE2LjIzYy44ODUtMS42NzcgMi41Ni0yLjcxMiA0LjcyMy0yLjcxMiAxLjMzMi4wMDIgMi41Ni4zNDYgMy42OTIgMS4xMzV6bTguOTA0IDUuMDhjMC0zLjk0NiAyLjgwNi02LjQxIDYuNTktNi40MSAzLjg0IDAgNi41OTUgMi40NjQgNi41OTUgNi40MSAwIDMuOS0yLjc1NiA2LjQxNS02LjU5NCA2LjQxNS0zLjc4NiAwLTYuNTkyLTIuNTE0LTYuNTkyLTYuNDEzem0tMTU1Ljg5NSAwYzAtMy45NDYgMi44MDMtNi40MSA2LjU5LTYuNDEgMy44NCAwIDYuNTkzIDIuNDY0IDYuNTkzIDYuNDEgMCAzLjktMi43NTQgNi40MTUtNi41OSA2LjQxNS0zLjc4OCAwLTYuNTk0LTIuNTE0LTYuNTk0LTYuNDEzem0xOTEuNDYyIDYuNDE1Yy0zLjc4NyAwLTYuNTktMi41MTQtNi41OS02LjQxMyAwLTMuOTQ3IDIuODAzLTYuNDEyIDYuNTktNi40MTIgMy44MzcgMCA2LjU5IDIuNDY1IDYuNTkgNi40MTIgMCAzLjktMi43NTMgNi40MTQtNi41OSA2LjQxNHpNMTM4LjU5NCA0NC44OGgtMTIuNTkyYy43MzgtMi45MSAyLjk1LTQuNDkgNi4yOTUtNC40OSAzLjM5NSAwIDUuNjEgMS41OCA2LjI5NyA0LjQ5em03OC4yNjggMEgyMDQuMjdjLjczNy0yLjkxIDIuOTUtNC40OSA2LjI5NS00LjQ5IDMuMzk1IDAgNS42MSAxLjU4IDYuMjk3IDQuNDl6bS0yNy42OTUgMTUuMDQ4bDYuODQtMjUuNDU3aC03LjEzNGwtNS4wMTYgMjAuNjIyLTUuMDItMjAuNjIzaC03LjAzNWw2Ljg0IDI1LjQ1NWgxMC41MjV6bS0yNy40IDBoNi41MzhWMzQuNDY4aC02LjU0djI1LjQ1OHptLTE4LjIzMy0yLjQ0bC0yLjUwOC01LjYyM2MtMi4zNjIgMS4yMzMtNC45NyAxLjk3My03LjYyNiAxLjk3My0zLjQ0MiAwLTUuODUzLTEuMzMyLTYuODg3LTMuOGgxOC4zOTdjLjE5Ny0uOTM2LjI5Ny0xLjg3My4yOTctMy4wMDggMC03Ljg5NC01LjQ2LTEzLjE3My0xMi43OS0xMy4xNzMtNy4zNzggMC0xMi43OSA1LjMzLTEyLjc5IDEzLjI3MiAwIDguMDkgNS4zNjIgMTMuMjcgMTMuNjc2IDEzLjI3IDMuNjQgMCA3LjIzLS45ODcgMTAuMjMtMi45MXptMTQzLjUyOC0yMy41NmMtNy40MyAwLTEyLjkzOCA1LjM3Ny0xMi45MzggMTMuMjcgMCA3Ljg5NiA1LjUxIDEzLjI3MiAxMi45MzcgMTMuMjcyIDcuNDMgMCAxMi45NC01LjM3NiAxMi45NC0xMy4yNyAwLTcuODk1LTUuNTEtMTMuMjcyLTEyLjkzOC0xMy4yNzJ6bS02NS4zNzcgMjMuNjNsLTIuNTEtNS42MjVjLTIuMzYzIDEuMjM0LTQuOTcgMS45NzMtNy42MjcgMS45NzMtMy40NDMgMC01Ljg1NC0xLjMzLTYuODg3LTMuOGgxOC40Yy4xOTctLjkzNi4yOTQtMS44NzMuMjk0LTMuMDA3IDAtNy44OTQtNS40Ni0xMy4xNzMtMTIuNzktMTMuMTczLTcuMzggMC0xMi43OSA1LjMyNy0xMi43OSAxMy4yNzIgMCA4LjA5IDUuMzYzIDEzLjI3IDEzLjY3NiAxMy4yNyAzLjY0LjAwMyA3LjIzLS45ODMgMTAuMjM1LTIuOTA4em00OS4zMzgtMTAuMzZjMC03Ljg5My01LjUxLTEzLjI3LTEyLjkzOC0xMy4yNy03LjQzIDAtMTIuOTM4IDUuMzc3LTEyLjkzOCAxMy4yNyAwIDcuODk2IDUuNTEgMTMuMjcyIDEyLjkzNyAxMy4yNzIgNy40MyAwIDEyLjk0LTUuMzc2IDEyLjk0LTEzLjI3ek0xNTUuOTEgNTkuOTI3VjIzLjE3aC02LjU0MnYzNi43NTVoNi41NDJ6bTEzLjIzMy0zMy4xMDhjMC0yLjM2OC0xLjc3LTQuMTQ0LTQuMDgyLTQuMTQ0LTIuMzYgMC00LjEzIDEuNzc2LTQuMTMgNC4xNDQgMCAyLjM2OCAxLjc3IDQuMTQ0IDQuMTMyIDQuMTQ0IDIuMzEgMCA0LjA4LTEuNzc2IDQuMDgtNC4xNDR6TTQ4LjkxNiAzNS4yNzZsLTYuMzktMjkuNzQtMjAuMDMgNC4yMTUgNi4zODUgMjkuNzRMMCA0NS41NjMgNS4xIDY5LjMyIDU1Ljg5IDgwbDExLjYxNC0yNS44MTNMNzMuMDMgMi4xMiA1Mi42NiAwbC0zLjc0NCAzNS4yNzZ6TTMyLjcxMiA1MS41NTJjLTEuNDY2LS40ODItMi4xMTgtMi4yMzctMS41NjItNC4zNi40MTQtMS41NzUgMi4zNjItMS44MSAzLjMzNy0xLjgyOC4zNy0uMDA2LjczNS4wNjggMS4wNy4yMTguNjkuMzEgMS44NTcuOTY4IDIuMDk0IDEuOTczLjM0MyAxLjQ1LjAxMyAyLjY2Ny0xLjAzNCAzLjYxNi0xLjA1Ljk1My0yLjQzNC44NjYtMy45MDQuMzgyem0xMy44ODIgMS43ODhjLTEuMzI0LS42NDItMS4zMTQtMi4yNzctMS4xNy0zLjI3NC4wNzgtLjU0My4yOTgtMS4wNTUuNjQyLTEuNDg3LjQ3My0uNTk0IDEuMjYzLTEuMzY3IDIuMTc1LTEuMzkgMS40ODUtLjA0IDIuNzYyLjYyIDMuNDgzIDEuODEyLjcyNCAxLjE4OC4zNjIgMi40OTgtLjQgMy44MS0uNzY3IDEuMzA3LTIuNzY0IDEuNDgtNC43My41Mjh6IiBmaWxsPSIjMDBDQ0JDIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=" alt="Deliveroo Clone Logo" width="200"/>

# Deliveroo Clone API

Node.js backend API for a Deliveroo clone application with microservice architecture.

</div>

## Tech Stack

- **Runtime:** Node.js with TypeScript
- **Framework:** Express.js
- **Database:** MongoDB (Mongoose ODM)
- **Authentication:** JWT with separate Auth Microservice
- **Validation:** Zod schemas
- **Documentation:** Swagger/OpenAPI
- **Package Manager:** Yarn 4.12.0

## Architecture

This API follows a microservice architecture pattern:

- **Main API** - Gateway service handling restaurants, dishes, categories, cart, and users
- **Auth Microservice** - Separate service handling authentication, authorization, and password management

## Project Structure

```text
src/
├── controllers/     # Request handlers
├── dto/            # Data Transfer Objects
├── middleware/     # Express middleware (validation, authorization)
├── models/         # Mongoose models
├── routes/         # Express route definitions
├── schema/         # Zod validation schemas
├── services/       # Business logic and external service clients
├── types/          # TypeScript type definitions
├── utils/          # Utility functions
├── server.ts       # Application entry point
└── swagger.ts      # Swagger configuration
```

## Prerequisites

- Node.js 18+
- MongoDB instance
- Yarn package manager
- Doppler CLI (for environment variables management)
- Access to Auth Microservice

## Environment Variables

Required environment variables:

```env
DATABASE_URL=mongodb://localhost:27017/deliveroo-clone
AUTH_SERVICE_URL=http://localhost:3000
AUTH_API_KEY=your-api-key-here
LOGO_URL=https://your-cdn.com/logo.png
```

## Installation

```bash
# Install dependencies
yarn install

# Build TypeScript
yarn build
```

## Development

```bash
# Run with Doppler (recommended)
yarn dev

# Or run directly with environment variables
nodemon src/server.ts
```

The server runs on **<http://localhost:4000>**

## API Documentation

Swagger documentation is available at:

- **Local:** <http://localhost:4000/api-docs>

## API Endpoints

### Authentication (Proxied to Auth Microservice)

- `POST /auth/check-email` - Check if email exists
- `POST /auth/signup` - Register new user
- `POST /auth/login` - User login
- `POST /auth/refresh` - Refresh access token
- `POST /auth/forgot-password` - Request password reset
- `POST /auth/reset-password` - Reset password with token

### Restaurants

- `GET /restaurants` - Get all restaurants
- `GET /restaurants/:orgID` - Get restaurant by ID
- `POST /restaurants` - Create restaurant (Admin)
- `PUT /restaurants/:id` - Update restaurant (Admin)
- `DELETE /restaurants/:id` - Delete restaurant (Admin)

### Dishes

- `GET /dishes` - Get all dishes (with optional filters)
- `GET /dishes/:id` - Get dish by ID
- `POST /dishes` - Create dish (Admin)
- `PUT /dishes/:id` - Update dish (Admin)
- `DELETE /dishes/:id` - Delete dish (Admin)

### Categories

- `GET /categories` - Get all categories
- `GET /categories/:id` - Get category by ID
- `POST /categories` - Create category (Admin)
- `PUT /categories/:id` - Update category (Admin)
- `DELETE /categories/:id` - Delete category (Admin)

### Cart

- `GET /cart` - Get user's cart
- `POST /cart` - Add item to cart
- `PUT /cart/:id` - Update cart item
- `DELETE /cart/:id` - Remove cart item

### Users

- `GET /users` - Get all users (Admin)
- `GET /users/:id` - Get user by ID
- `PUT /users/:id` - Update user
- `DELETE /users/:id` - Delete user

## Scripts

```bash
# Development
yarn dev              # Run with hot reload (requires Doppler)

# Build
yarn build            # Compile TypeScript

# Code Quality
yarn lint:fix         # Fix ESLint issues
yarn format:fix       # Format code with Prettier
```

## Authorization

### Role-Based Access Control

- **Admin routes** require JWT token with `role: "admin"`
- **User routes** require valid JWT token
- Authorization header: `Bearer <token>`

### Middleware

- `authorizeUser` - Validates JWT token
- `authorizeAdmin` - Validates JWT token and checks for admin role
- `optionalAuthorizeRole` - Conditionally applies role authorization

## Validation

All request validation is handled by Zod schemas:

- Request body validation via `ValidateBody` middleware
- Query parameter validation via `ValidateQuery` middleware
- URL parameter validation via `ValidateParams` middleware

## Database Models

- **User** - User accounts and profiles
- **Restaurant** - Restaurant information
- **Dish** - Menu items with categories
- **Category** - Dish categories
- **Cart** - User shopping carts
- **ResetPassword** - Password reset tokens

## Docker Support

See [README.Docker.md](./README.Docker.md) for Docker deployment instructions.

## Contributing

1. Create a feature branch from `develop`
2. Make your changes
3. Run linting and formatting: `yarn lint:fix && yarn format:fix`
4. Commit with conventional commits
5. Create a pull request to `develop`

## Branch Structure

- `main` - Production-ready code
- `develop` - Development branch
- `improvements/*` - Feature branches

## License

ISC

## Author

DiluDevX

## Repository

<https://github.com/DiluDevX/deliveroo-clone-api>
